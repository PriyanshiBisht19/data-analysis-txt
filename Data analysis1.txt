create database	olist;

use olist;

show tables;

RENAME TABLE `order` TO orders;

SELECT* from olist_customers_dataset;

SELECT count(*) from olist_customers_dataset;

SELECT COUNT(*) FROM `order`;

SELECT COUNT(*) FROM `products`;

SELECT count(distinct customer_unique_id) as unique_customer 
from olist_customers_dataset;

select customer_unique_id, count(*) as orders
from olist_customer_dataset
group by unique_customer_id
having count(*) > 1 ;

select customer_state, count(*) as total_customers
from olist_customers_dataset
group by customer_state 
order by total_customers desc
limit 20 ;

SELECT customer_city, COUNT(*) AS total_customers
FROM olist_customers_dataset
GROUP BY customer_city
ORDER BY total_customers DESC
LIMIT 20;

SELECT COUNT(*) AS total_payments
FROM payments;

SELECT SUM(payment_value) AS total_revenue
FROM payments;

SELECT AVG(payment_value) AS avg_payment
FROM payments;

SELECT 
    payment_type,
    COUNT(*) AS total_transactions,
    SUM(payment_value) AS total_amount
FROM payments
GROUP BY payment_type
ORDER BY total_amount DESC;

SELECT 
    payment_installments,
    COUNT(*) AS total_transactions
FROM payments
GROUP BY payment_installments
ORDER BY payment_installments;

-- SELECT COUNT(*) AS total_products
-- FROM products;

SELECT 
    product_category_name,
    COUNT(*) AS total_products
FROM products
GROUP BY product_category_name
ORDER BY total_products DESC
LIMIT 10;

SELECT 
    AVG(product_weight_g) AS avg_weight,
    MAX(product_weight_g) AS max_weight,
    MIN(product_weight_g) AS min_weight
FROM products;

SELECT AVG(payment_value) AS avg_payment
FROM payments;

SELECT SUM(payment_value) AS total_revenue
FROM payments;

SELECT 
    payment_type,
    COUNT(*) AS total_transactions,
    ROUND(SUM(payment_value),2) AS total_amount
FROM payments
GROUP BY payment_type
ORDER BY total_amount DESC;

SELECT 
    payment_type,
    ROUND(AVG(payment_value),2) AS avg_payment
FROM payments
GROUP BY payment_type
ORDER BY avg_payment DESC;